<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-01-25 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20140125" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Liquibase Maven Plugin - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

                          
        
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans+Condensed:300"/>
          
                  </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/ljnelson/liquibase-maven-plugin">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Liquibase Maven Plugin</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2014-01-25
                   </li>
                      
                
                    
                <li id="projectVersion" class="pull-right">Version: 1.0.0</li>
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Usage Documentation</li>
                              
      <li>
  
                          <a href="index.html" title="Overview">
          <i class="none"></i>
        Overview</a>
            </li>
                
      <li>
  
                          <a href="plugin-info.html" title="Goals">
          <i class="none"></i>
        Goals</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>Usage</a>
          </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                      
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <!-- -*- markdown -*- -->
<h1>Usage</h1>
<p>This document describes different ways of using the <tt>liquibase-maven-plugin</tt> project. For more details, please see the <a href="plugin-info.html">Goals</a> page.</p>

<div class="section">
<h2>Generic Plugin configuration information<a name="Generic_Plugin_configuration_information"></a></h2>
<p>See the following links for information about including and configuring plugins in your project:</p>

<ul>
  
<li>
<p><a class="externalLink" href="http://maven.apache.org/guides/mini/guide-configuring-plugins.html">Configuring Plugins</a></p></li>
  
<li>
<p><a class="externalLink" href="http://maven.apache.org/guides/plugin/guide-java-plugin-development.html">Plugin Development</a></p></li>
  
<li>
<p><a class="externalLink" href="http://maven.apache.org/guides/introduction/introduction-to-plugin-prefix-mapping.html">Plugin Prefix Resolution</a></p></li>
</ul>
</div>
<div class="section">
<h2><tt>liquibase:assembleChangeLog</tt><a name="liquibase:assembleChangeLog"></a></h2>

<div class="section">
<h3>Summary<a name="Summary"></a></h3>
<p>The <tt>liquibase:assembleChangeLog</tt> goal constructs a <a class="externalLink" href="http://www.liquibase.org/documentation/databasechangelog.html">changelog</a> that <a class="externalLink" href="http://www.liquibase.org/documentation/include.html">includes</a> other changelogs it finds in <tt>test</tt> scope (by default) throughout the project&#x2019;s transitive dependencies. The changelogs that are included are included in dependency order.</p>
<p>This allows you to notionally break what would otherwise be a giant, monolithic changelog into small, modular pieces, and allows those pieces to combine together in the proper dependency order at, for example, test time, such that foreign keys and other cross-module concerns continue to work properly.</p>
</div>
<div class="section">
<h3>Getting Started<a name="Getting_Started"></a></h3>
<p>The first step in getting started with the <tt>liquibase:assembleChangeLog</tt> goal is to organize your projects&#x2019; changelogs properly in terms of dependency order.</p>
<p>Next, you&#x2019;ll need to make sure they all have the same <i>classpath resource name</i>.</p>
<p>Finally, you&#x2019;ll configure and run the <tt>liquibase:assembleChangeLog</tt> mojo/goal so that it will automatically discover all of these, sort them appropriately, and generate a master &#x201c;aggregator&#x201d; changelog that will <a class="externalLink" href="http://www.liquibase.org/documentation/include.html">include</a> all the discovered fragments.</p>
<p>For this example, we&#x2019;ll pretend that we have a <tt>person</tt> Maven project/artifact and an <tt>address</tt> Maven project/artifact that depends on the <tt>person</tt> artifact in <tt>compile</tt> scope.</p>

<div class="section">
<h4>Organizing Changelogs in Dependency Order<a name="Organizing_Changelogs_in_Dependency_Order"></a></h4>
<p>The <tt>person</tt> project, let&#x2019;s say, will need a changelog that creates a <tt>person</tt> table in a database somewhere. Most notably, it will not create any address tables; we&#x2019;ll leave that up to the address module.</p>
<p>Here&#x2019;s what it might look like:</p>

<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;databaseChangeLog xmlns=&quot;http://www.liquibase.org/xml/ns/dbchangelog&quot;
                   xmlns:ext=&quot;http://www.liquibase.org/xml/ns/dbchangelog-ext&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
                   xsi:schemaLocation=&quot;http://www.liquibase.org/xml/ns/dbchangelog 
                                       http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd&quot;&gt;
  &lt;changeSet id=&quot;person:table_creation&quot; author=&quot;ljnelson&quot; logicalFilePath=&quot;person&quot;&gt;
    &lt;createTable tableName=&quot;person&quot;&gt;
      &lt;column name=&quot;id&quot; type=&quot;bigint&quot;/&gt;
    &lt;/createTable&gt;
    &lt;addPrimaryKey columnNames=&quot;id&quot;
                   constraintName=&quot;person_pk&quot;
                   tableName=&quot;person&quot;/&gt;
  &lt;/changeSet&gt;
&lt;/databaseChangeLog&gt;
</pre></div>
<p>The <tt>address</tt> project, in turn, will need a changelog that creates an <tt>address</tt> table in a database somewhere, and, let&#x2019;s further suppose, will have a foreign key reference of some kind to a previously constructed <tt>person</tt> table. Note that the <tt>address</tt> project will not take responsibility for creating this <tt>person</tt> table; it will only presuppose that such a table will already exist in the database by the time its own DDL activities begin. Here&#x2019;s what it might look like:</p>

<div class="source">
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;databaseChangeLog xmlns=&quot;http://www.liquibase.org/xml/ns/dbchangelog&quot;
                   xmlns:ext=&quot;http://www.liquibase.org/xml/ns/dbchangelog-ext&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
                   xsi:schemaLocation=&quot;http://www.liquibase.org/xml/ns/dbchangelog 
                                       http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd&quot;&gt;
  &lt;changeSet id=&quot;address:table_creation&quot; author=&quot;ljnelson&quot; logicalFilePath=&quot;address&quot;&gt;
    &lt;createTable tableName=&quot;address&quot;&gt;
      &lt;column name=&quot;id&quot; type=&quot;bigint&quot;/&gt;
      &lt;column name=&quot;person_id&quot; type=&quot;bigint&quot;&gt;
        &lt;constraints nullable=&quot;false&quot;/&gt;
      &lt;/column&gt;
    &lt;/createTable&gt;
    &lt;addPrimaryKey columnNames=&quot;id&quot;
                   constraintName=&quot;address_pk&quot;
                   tableName=&quot;address&quot;/&gt;
    &lt;addForeignKeyConstraint baseColumnNames=&quot;person_id&quot;
                             baseTableName=&quot;address&quot;
                             constraintName=&quot;fk_address_person&quot;
                             referencedColumnNames=&quot;id&quot;
                             referencedTableName=&quot;person&quot;/&gt;
  &lt;/changeSet&gt;
&lt;/databaseChangeLog&gt;
</pre></div>
</div>
<div class="section">
<h4>Naming Changelog Fragments<a name="Naming_Changelog_Fragments"></a></h4>
<p>The changelogs in question will have to live in the artifacts produced by the projects in question, and, for the <tt>liquibase:assembleChangeLog</tt> mojo to be able to find them, will need to live in the same place in each <tt>.jar</tt> file, so that the plugin can discover them as classpath resources.</p>
<p>A good candidate for this location is the <tt>META-INF</tt> directory. Within that directory, we&#x2019;ll place our <a class="externalLink" href="http://www.liquibase.org/">Liquibase</a> artifacts in a <tt>liquibase</tt> directory, and we&#x2019;ll call our changelogs <tt>changelog.xml</tt>. So the final classpath resource name of the changelogs used in this example will be <tt>META-INF/liquibase/changelog.xml</tt>.</p>
<p>Consequently, we&#x2019;ll place <tt>src/main/resources/META-INF/liquibase</tt> directories in both the <tt>person</tt> and <tt>address</tt> Maven projects, and will take our two changelog files from above and place them in files named <tt>src/main/resources/META-INF/liquibase/changelog.xml</tt>.</p>
<p>When we build these projects, the resulting <tt>.jar</tt> files will contain <tt>META-INF/liquibase</tt> directories at their root, with a single <tt>changelog.xml</tt> file in each.</p>
</div>
<div class="section">
<h4>Configuring the <tt>liquibase:assembleChangeLog</tt> Mojo<a name="Configuring_the_liquibase:assembleChangeLog_Mojo"></a></h4>
<p>Now that we have two independent <tt>.jar</tt> files being produced by two Maven projects with Liquibase changelogs in them and a Maven dependency relationship between them but no other connection between them, we can set up the plugin to run.</p>

<div class="section">
<h5>Deciding on a Build Phase<a name="Deciding_on_a_Build_Phase"></a></h5>
<p>The <tt>liquibase:assembleChangeLog</tt> mojo has several possible applications. For this example, we&#x2019;ll build an aggregate changelog for integration testing. Consequently, since we&#x2019;ll be generating a changelog for use at test time, we&#x2019;ll bind this mojo to the <tt>generate-test-resources</tt> phase.</p>
</div>
<div class="section">
<h5>Activating the Mojo<a name="Activating_the_Mojo"></a></h5>
<p>Here is what the basic plugin activation stanza looks like with no configuration information other than phase binding:</p>

<div class="source">
<pre>&lt;plugin&gt;
  &lt;groupId&gt;com.edugility&lt;/groupId&gt;
  &lt;artifactId&gt;liquibase-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;1.0.0&lt;/version&gt;
  &lt;executions&gt;
    &lt;execution&gt;
      &lt;id&gt;Assemble aggregate changelog for integration testing&lt;/id&gt;
      &lt;phase&gt;generate-test-resources&lt;/phase&gt;
      &lt;goals&gt;
        &lt;goal&gt;assembleChangeLog&lt;/goal&gt;
      &lt;/goals&gt;
    &lt;/execution&gt;
  &lt;/executions&gt;
&lt;/plugin&gt;
</pre></div>
<p>Many configuration parameters (as described in the <a href="assembleChangeLog-mojo.html">reference documentation</a>) have sensible default values. Consequently, the configuration above will (conveniently enough!) look for changelog resources stored under the <a href="assembleChangeLog-mojo.html#changeLogResourceNames">classpath resource name</a> of <tt>META-INF/liquibase/changelog.xml</tt>, and will write its <a href="assembleChangeLog-mojo.html#outputFile">output file</a> to <tt>${project.build.directory}/generated-sources/liquibase/changelog.xml</tt>.</p></div></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2013&#x2013;2014
                        <a href="http://www.edugility.com/">Edugility</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
